/*
 * g.Raphael 0.2 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */


Raphael.fn.g.dotchart=function(l,j,A,E,T,S,N,d){function r(R){+R[0]&&(R[0]=B.g.axis(l+M,j+M,A-2*M,W,J,d.axisxstep||Math.floor((A-2*M)/20),2,d.axisxlabels||null,d.axisxtype||"t"));+R[1]&&(R[1]=B.g.axis(l+A-M,j+E-M,E-2*M,V,I,d.axisystep||Math.floor((E-2*M)/20),3,d.axisylabels||null,d.axisytype||"t"));+R[2]&&(R[2]=B.g.axis(l+M,j+E-M+c,A-2*M,W,J,d.axisxstep||Math.floor((A-2*M)/20),0,d.axisxlabels||null,d.axisxtype||"t"));+R[3]&&(R[3]=B.g.axis(l+M-c,j+E-M,E-2*M,V,I,d.axisystep||Math.floor((E-2*M)/20),1,d.axisylabels||null,d.axisytype||"t"));}d=d||{};var Q=this.g.snapEnds(Math.min.apply(Math,T),Math.max.apply(Math,T),T.length-1),W=Q.from,J=Q.to,M=d.gutter||10,h=this.g.snapEnds(Math.min.apply(Math,S),Math.max.apply(Math,S),S.length-1),V=h.from,I=h.to,U=Math.max(T.length,S.length,N.length),P=this.g.markers[d.symbol]||"disc",e=this.set(),O=this.set(),a=d.max||100,L=Math.max.apply(Math,N),K=[],B=this,o=Math.sqrt(L/Math.PI)*2/a;for(var p=0;p<U;p++){K[p]=Math.min(Math.sqrt(N[p]/Math.PI)*2/o,a);}M=Math.max.apply(Math,K.concat(M));var Z=this.set(),c=Math.max.apply(Math,K);if(d.axis){var H=(d.axis+"").split(/[,\s]+/);r(H);var q=[],s=[];for(var p=0,f=H.length;p<f;p++){var t=H[p].all?H[p].all.getBBox()[["height","width"][p%2]]:0;q[p]=t+M;s[p]=t;}M=Math.max.apply(Math,q.concat(M));for(var p=0,f=H.length;p<f;p++){if(H[p].all){H[p].remove();H[p]=1;}}r(H);for(var p=0,f=H.length;p<f;p++){if(H[p].all){Z.push(H[p].all);}}e.axis=Z;}var n=(A-M*2)/((J-W)||1),m=(E-M*2)/((I-V)||1);for(var p=0,f=S.length;p<f;p++){var D=this.raphael.isArray(P)?P[p]:P,G=l+M+(T[p]-W)*n,F=j+E-M-(S[p]-V)*m;D&&K[p]&&O.push(this.g[D](G,F,K[p]).attr({fill:d.heat?this.g.colorValue(K[p],c):Raphael.fn.g.colors[0],"fill-opacity":d.opacity?K[p]/a:1,stroke:"none"}));}var C=this.set();for(var p=0,f=S.length;p<f;p++){var G=l+M+(T[p]-W)*n,F=j+E-M-(S[p]-V)*m;C.push(this.circle(G,F,c).attr({fill:"#000",stroke:"none",opacity:0}));d.href&&d.href[p]&&C[p].attr({href:d.href[p]});C[p].r=+K[p].toFixed(3);C[p].x=+G.toFixed(3);C[p].y=+F.toFixed(3);C[p].X=T[p];C[p].Y=S[p];C[p].value=N[p]||0;C[p].dot=O[p];}e.covers=C;e.series=O;e.push(O,Z,C);e.hover=function(X,R){C.mouseover(X).mouseout(R);return this;};e.click=function(R){C.click(R);return this;};e.href=function(Y){var X;for(var R=C.length;R--;){X=C[R];if(X.X==Y.x&&X.Y==Y.y&&X.value==Y.value){X.attr({href:Y.href});}}};return e;};